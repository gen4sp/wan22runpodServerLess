# ‚úÖ –°–∏—Å—Ç–µ–º–∞ JSON –≤–æ—Ä–∫—Ñ–ª–æ—É - –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

-   ‚úÖ **T2V (Text-to-Video)** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
-   ‚úÖ **T2I (Text-to-Image)** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
-   ‚úÖ **Img2Img (Image-to-Image)** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
-   ‚úÖ **Video Upscale** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
-   ‚úÖ **–í–æ—Ä–∫—Ñ–ª–æ—É –∫–∞–∫ –ø–æ–ª–Ω—ã–π JSON** - –Ω–∏–∫–∞–∫–∏—Ö –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏:

-   `workflows/base.py` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤–æ—Ä–∫—Ñ–ª–æ—É
-   `workflows/loader.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö JSON –≤–æ—Ä–∫—Ñ–ª–æ—É
-   `workflows/__init__.py` - —ç–∫—Å–ø–æ—Ä—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã:

#### `WorkflowAnalyzer`

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç JSON –≤–æ—Ä–∫—Ñ–ª–æ—É –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø–æ —É–∑–ª–∞–º ComfyUI:

-   –ò—â–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —É–∑–ª—ã (`CLIPTextEncode`, `WanImageToVideo`, `SaveImage`, etc.)
-   –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–¥–∏–Ω –∏–∑ 5 —Ç–∏–ø–æ–≤: T2V, T2I, Img2Img, Video Upscale, Unknown

#### `WorkflowProcessor`

–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –≤–æ—Ä–∫—Ñ–ª–æ—É –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é:

-   –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –≤ —É–∑–ª–∞—Ö `CLIPTextEncode`
-   –ó–∞–º–µ–Ω—è–µ—Ç –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –≤ `LoadImage`/`LoadVideo`
-   –ü—Ä–∏–º–µ–Ω—è–µ—Ç –æ–ø—Ü–∏–∏ (seed, steps, cfg)

#### `WorkflowHandler`

–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å:

-   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
-   –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–∏–ø—É –≤–æ—Ä–∫—Ñ–ª–æ—É
-   –°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
=== –¢–µ—Å—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤–æ—Ä–∫—Ñ–ª–æ—É ===
  T2V (WAN 2.2): text_to_video ‚úì
  T2I (Stable Diffusion): text_to_image ‚úì
  Img2Img: image_to_image ‚úì
  Video Upscale: video_upscale ‚úì

=== –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–æ—Ä–∫—Ñ–ª–æ—É ===
  ‚úì –ü—Ä–æ–º–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  ‚úì –°–∏–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

=== –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ===
  ‚úì –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è T2V –±–µ–∑ –ø—Ä–æ–º–ø—Ç–∞
  ‚úì –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è Img2Img –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

## üìù –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç API

### –ó–∞–ø—Ä–æ—Å:

```json
{
    "input": {
        "workflow": {
            /* –ü–û–õ–ù–´–ô JSON ComfyUI */
        },
        "prompt": "–û–ø–∏—Å–∞–Ω–∏–µ (–¥–ª—è T2V/T2I)",
        "image": "data:image/png;base64,... (–¥–ª—è Img2Img)",
        "video": "data:video/mp4;base64,... (–¥–ª—è Video Upscale)",
        "options": { "seed": 12345, "steps": 20, "cfg": 7.0 }
    }
}
```

### –û—Ç–≤–µ—Ç:

```json
{
    "video": "base64_data", // –∏–ª–∏ "image"
    "filename": "output.mp4",
    "prompt_id": "12345",
    "workflow_type": "text_to_video",
    "metadata": {
        "workflow_type": "text_to_video",
        "node_count": 11,
        "has_prompt": true,
        "has_image": false,
        "options_applied": true
    }
}
```

## üéõÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

1. **–ê–Ω–∞–ª–∏–∑ –≤–æ—Ä–∫—Ñ–ª–æ—É** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ —É–∑–ª–∞–º
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —Ç–∏–ø–∞
3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** - –≤ `/comfyui/input/`
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤** - –≤ —É–∑–ª–∞—Ö `CLIPTextEncode`
5. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ü–∏–π** - seed, steps, cfg –∏ –¥—Ä.
6. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤** - –≤ `LoadImage`/`LoadVideo`

## üìã –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### WAN 2.2 T2V

```json
{
    "input": {
        "prompt": "Beautiful mountain landscape",
        "workflow": {
            "6": {
                "class_type": "CLIPTextEncode",
                "inputs": { "text": "placeholder" }
            },
            "50": { "class_type": "WanImageToVideo" },
            "64": { "class_type": "VHS_VideoCombine" }
        }
    }
}
```

### Stable Diffusion T2I

```json
{
    "input": {
        "prompt": "Beautiful sunset",
        "workflow": {
            "1": { "class_type": "CLIPTextEncode" },
            "3": { "class_type": "KSampler" },
            "5": { "class_type": "EmptyLatentImage" },
            "7": { "class_type": "SaveImage" }
        }
    }
}
```

### Image-to-Image

```json
{
    "input": {
        "image": "data:image/png;base64,...",
        "prompt": "Transform to painting style",
        "workflow": {
            "5": { "class_type": "LoadImage" },
            "3": { "class_type": "KSampler" },
            "9": { "class_type": "SaveImage" }
        }
    }
}
```

### Video Upscale

```json
{
    "input": {
        "video": "data:video/mp4;base64,...",
        "workflow": {
            "1": { "class_type": "VHS_LoadVideo" },
            "2": { "class_type": "ImageUpscaleWithModel" },
            "3": { "class_type": "VHS_VideoCombine" }
        }
    }
}
```

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ê–Ω–∞–ª–∏–∑ –≤–æ—Ä–∫—Ñ–ª–æ—É

```json
{
    "input": {
        "action": "analyze_workflow",
        "workflow": {
            /* –≤–∞—à –≤–æ—Ä–∫—Ñ–ª–æ—É */
        }
    }
}
```

## üìÇ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
workflows/
‚îú‚îÄ‚îÄ __init__.py          # –≠–∫—Å–ø–æ—Ä—Ç—ã
‚îú‚îÄ‚îÄ base.py             # WorkflowAnalyzer, WorkflowProcessor, WorkflowType
‚îî‚îÄ‚îÄ loader.py           # WorkflowHandler, process_workflow

test_input.json         # –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç WAN 2.2
test_json_workflows.json # –ü—Ä–∏–º–µ—Ä—ã –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
test_workflows.py       # –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
JSON_WORKFLOW_SYSTEM.md # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

-   **–ù–∏–∫–∞–∫–∏—Ö –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –≤–æ—Ä–∫—Ñ–ª–æ—É** - –ª—é–±–æ–π JSON ComfyUI
-   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞** - –ø–æ –∞–Ω–∞–ª–∏–∑—É —É–∑–ª–æ–≤
-   **–ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
-   **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤, —Ñ–∞–π–ª–æ–≤, –æ–ø—Ü–∏–π
-   **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
-   **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤** - T2V, T2I, Img2Img, Video Upscale

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

-   –ü—Ä—è–º–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ JSON –≤ ComfyUI –±–µ–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
-   –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ—Ä–∫—Ñ–ª–æ—É (—Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ)
-   –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –≤–æ—Ä–∫—Ñ–ª–æ—É. –ö–ª–∏–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ–ª–Ω—ã—Ö JSON –≤–æ—Ä–∫—Ñ–ª–æ—É –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω —à–∞–±–ª–æ–Ω–æ–≤.

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üéâ
